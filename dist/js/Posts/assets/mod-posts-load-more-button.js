var Modularity=Modularity||{};Modularity.Posts=Modularity.Posts||{},Modularity.Posts.LoadMoreButton=function(a){function o(){this.init()}return o.prototype.init=function(){a(document).on("click",".js-mod-posts-load-more",function(o){var t=a(o.target),e=JSON.parse(t.attr("data-mod-posts-load-more"));if(this.attributesExists(["postsPerPage","offset","target","ajaxUrl","nonce","bladeTemplate"],Object.keys(e))){var r=a(e.target)[0];if(void 0===r)throw'Error: Could not find target "'+e.target+'"';this.toggleLoader(t),this.loadMorePosts(t,r,e)}}.bind(this))},o.prototype.toggleLoader=function(o){if(o.hasClass("hidden"))return o.removeClass("hidden"),void this.removeLoader(o);o.addClass("hidden"),o.after('<div class="loading"><div></div><div></div><div></div><div></div></div>')},o.prototype.loadMorePosts=function(e,r,s){console.log("loadMorePosts()");var o=s;o.action="mod_posts_load_more",a.ajax({type:"post",url:o.ajaxUrl,data:o,success:function(o,t){return console.log(o),console.log(t),"success"==t?(a(r).append(o.join("")),s.postsPerPage>o.length?(this.removeLoader(e),void e.remove()):(this.toggleLoader(e),s.offset=parseInt(s.offset)+parseInt(s.postsPerPage),void e.attr("data-mod-posts-load-more",JSON.stringify(s)))):"nocontent"==t?(this.removeLoader(e),e.after("<p>No more posts to showâ€¦</p>"),void e.remove()):void 0}.bind(this),error:function(o,t,e){console.log(e)}})},o.prototype.removeLoader=function(o){a(o.next()).hasClass("loading")&&o.next().remove()},o.prototype.attributesExists=function(o,t){var e=!0;return o.forEach(function(o){if(!t.includes(o))throw e=!1,'ValidationError: Missing required data-attribute key "'+o+'"'}),e},new o}(jQuery);