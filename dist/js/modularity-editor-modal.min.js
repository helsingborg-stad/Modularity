!function(t){var o={};function e(i){if(o[i])return o[i].exports;var a=o[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=o,e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var a in t)e.d(i,a,function(o){return t[o]}.bind(null,a));return i},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=6)}([function(t,o,e){"use strict";var i=e(2),a=e(1),n=e(3);o.a=function(t){function o(){}return o.prototype.modulePostCreated=function(o){a.a.close();var e=i.a.isEditingModule(),d={action:"get_post",id:o};t.post(ajaxurl,d,(function(t){var o={post_id:t.ID,title:t.post_title};i.a.updateModule(e,o),n.a.save("form")}),"json")},new o}(jQuery)},function(t,o,e){"use strict";o.a=function(t){function o(){this.handleEvents()}return o.prototype.open=function(o){t("body").addClass("modularity-modal-open").append('            <div id="modularity-modal">                <div class="modularity-modal-wrapper">                    <button class="modularity-modal-close" data-modularity-modal-action="close">&times; '+modularityAdminLanguage.close+'</button>                    <div class="modularity-modal-spinner-container" id="modularity-iframe-loader"><span class="modularity-modal-spinner"></span></div>                    <iframe class="modularity-modal-iframe" src="'+o+'" frameborder="0" onload="document.getElementById(\'modularity-iframe-loader\').style.display=\'none\';" allowtransparency></iframe>                </div>            </div>        '),!0},o.prototype.close=function(){t("body").removeClass("modularity-modal-open"),t("#modularity-modal").remove(),!1},o.prototype.handleEvents=function(){t(document).on("click",'[data-modularity-modal-action="close"]',function(t){t.preventDefault(),this.close()}.bind(this))},new o}(jQuery)},function(t,o,e){"use strict";var i=e(0),a=e(5),n=e(1);o.a=function(t){var o={is_thickbox:!0},e=!1;function d(){t(function(){"undefined"!=typeof pagenow&&"admin_page_modularity-editor"==pagenow&&(this.handleEvents(),this.loadModules(modularity_post_id))}.bind(this))}return d.prototype.loadModules=function(o){var e={action:"get_post_modules",id:o};t.post(ajaxurl,e,function(o){t.each(o,function(o,e){var i=t('.modularity-sidebar-area[data-area-id="'+o+'"]');t.each(e.modules,function(o,e){"true"==e.hidden&&(e.hidden=!0);var a=void 0===e.sidebar_incompability||t.isEmptyObject(e.sidebar_incompability)?"":JSON.stringify(e.sidebar_incompability);this.addModule(i,e.post_type,e.post_type_name,e.post_title,e.ID,e.hidden,e.columnWidth,e.isDeprecated,a)}.bind(this)),i.removeClass("modularity-spinner")}.bind(this)),this.initCompleted=!0,t(".modularity-sidebar-area").removeClass("modularity-spinner")}.bind(this),"json")},d.prototype.isEditingModule=function(){return e},d.prototype.getThickBoxUrl=function(e,i){var a="",n={};switch(e){case"add":a="post-new.php";break;case"edit":a="post.php"}return"number"==typeof i.postId&&(n.post=i.postId,n.action="edit"),"string"==typeof i.postType&&(n.post_type=i.postType),admin_url+a+"?"+t.param(n)+"&"+t.param(o)},d.prototype.getImportUrl=function(e){var i={};return i.post_type=e.postType,admin_url+"edit.php?"+t.param(i)+"&"+t.param(o)},d.prototype.addModule=function(o,e,n,d,r,l,s,u,p){d=void 0!==d?": "+d:"",r=void 0!==r?r:"",s=void 0!==s?s:"";var c=!0===u?'<span class="modularity-deprecated" style="color:#ff0000;">('+modularityAdminLanguage.deprecated+")</span>":"";p=void 0!==p?p:"";var m=this.getThickBoxUrl("add",{postType:e});i.a.postAction="add",r&&(m=this.getThickBoxUrl("edit",{postId:r}),i.a.postAction="edit");var y=this.getImportUrl({postType:e}),f="";!0===l&&(f="checked");var h=t(o).data("area-id"),v=a.a.uuid(),b='<li id="post-'+r+'" data-module-id="'+e+'" data-module-stored-width="'+s+"\" data-sidebar-incompability='"+p+'\'>                <span class="modularity-line-wrapper">                    <span class="modularity-sortable-handle"></span>                    <span class="modularity-module-name">                        '+n+"                        "+c+'                        <span class="modularity-module-title">'+d+'</span>                        <label class="modularity-module-hide">                            <input type="checkbox" name="modularity_modules['+h+"]["+v+'][hidden]" value="hidden" '+f+" />                            "+modularityAdminLanguage.langhide+'                        </label>                    </span>                    <span class="modularity-module-columns">                        <label>'+modularityAdminLanguage.width+':</label>                        <select name="modularity_modules['+h+"]["+v+'][columnWidth]">                            '+modularityAdminLanguage.widthOptions+'                        </select>                    </span>                    <span class="modularity-module-actions">                        <a href="'+m+'" data-modularity-modal class="modularity-js-thickbox-open"><span>'+modularityAdminLanguage.langedit+'</span></a>                        <a href="'+y+'" class="modularity-js-thickbox-import"><span>'+modularityAdminLanguage.langimport+'</span></a>                        <a href="#remove" class="modularity-module-remove"><span>'+modularityAdminLanguage.langremove+'</span></a>                    </span>                    <input type="hidden" name="modularity_modules['+h+"]["+v+'][postid]" class="modularity-js-module-id" value="'+r+'" required>                </span>            </li>';t(o).append(b),t(".modularity-sidebar-area > li").each((function(o,e){t(".modularity-module-columns select",t(e)).val(t(e).attr("data-module-stored-width"))})),t(".modularity-js-sortable").sortable("refresh")},d.prototype.updateModule=function(t,o){t.find("a.modularity-js-thickbox-open").attr("href",this.getThickBoxUrl("edit",{postId:o.post_id})),t.find("input.modularity-js-module-id").val(o.post_id).change(),t.find(".modularity-module-title").text(": "+o.title)},d.prototype.removeModule=function(t){confirm(modularityAdminLanguage.actionRemove)&&t.remove()},d.prototype.handleEvents=function(){t(document).on("click",".modularity-module-remove",function(o){o.preventDefault();var e=t(o.target).closest("li");this.removeModule(e)}.bind(this)),t(document).on("click",".modularity-js-thickbox-import",(function(o){o.preventDefault();t(o.target).closest("a");e=t(o.target).closest("li"),i.a.postAction="import",n.a.open(t(o.target).closest("a").attr("href"))})),t(document).on("click",".modularity-js-thickbox-open",function(o){o.preventDefault(),t(o.target).closest("a").attr("href").indexOf("post.php")>-1&&(i.a.postAction="edit"),e=t(o.target).closest("li"),n.a.open(t(o.target).closest("a").attr("href"))}.bind(this))},new d}(jQuery)},function(t,o,e){"use strict";o.a=function(t){function o(){t(function(){}.bind(this))}return o.prototype.save=function(o){t("#modularity-options #publishing-action .spinner").css("visibility","visible");var e=t(o).serializeObject();e.id=modularity_post_id,e.action="save_modules",t.post(ajaxurl,e,(function(o){t("#modularity-options #publishing-action .spinner").css("visibility","hidden")}))},new o}(jQuery)},function(t,o,e){"use strict";var i=e(0),a=e(2),n=e(1);o.a=function(t){var o=!1;function e(){t(function(){t(document).on("click",".modularity-js-thickbox-widget-import-widget",(function(e){e.preventDefault(),o=t(e.target).parents(".widget-inside");var d=a.a.getImportUrl({postType:t(e.target).parents(".widget-inside").find(".modularity-widget-module-type select").val()});a.a.editingModule=t(e.target).closest(".widget-inside"),i.a.postAction="import-widget",n.a.open(d)})),t(document).on("click",".modularity-js-thickbox-open-widget",function(o){o.preventDefault(),t(o.target).closest("a").attr("href").indexOf("post.php")>-1&&(i.a.postAction="edit");t(o.target).closest("li");n.a.open(t(o.target).closest("a").attr("href"))}.bind(this))}.bind(this))}return e.prototype.isEditingWidget=function(){return o},e.prototype.updateWidget=function(o,e){t(o).find(".modularity-widget-module-id-span").html(e.post_id),t(o).find(".modularity-widget-module-id").val(e.post_id),t(o).find(".modularity-widget-module-edit").attr("href","post.php?post="+e.post_id+"&action=edit&is_thickbox=true").removeClass("hidden"),t(o).find(".modularity-widget-module-title-span").html(e.title),t(o).find(".modularity-widget-module-title").val(e.title)},new e}(jQuery)},function(t,o,e){"use strict";o.a=function(t){function o(){t(function(){}.bind(this))}return o.prototype.uuid=function(t){return Math.random().toString(36).substr(2,9)},new o}(jQuery)},function(t,o,e){"use strict";e.r(o);var i,a=e(0),n=e(2),d=e(3),r=e(1),l=e(4);o.default=(i=jQuery,"add"==a.a.postAction&&""==modularity_post_action&&a.a.modulePostCreated(modularity_post_id),"edit-inline-saved"==a.a.postAction&&parent.location.reload(),"edit"==a.a.postAction&&""==modularity_post_action&&jQuery(document).on("click","#publish",(function(t){a.a.postAction="add"})),"edit-inline-not-saved"==a.a.postAction&&jQuery(document).on("click","#publish",(function(t){a.a.postAction="edit-inline-saved"})),"import"==a.a.postAction&&(i('.check-column input[type="checkbox"]').remove(),i(".wp-list-table").addClass("modularity-wp-list-table"),i("tbody .check-column").addClass("modularity-import-column").append('<button class="button modularity-import-button" data-modularity-action="import">Import</button>'),i("#posts-filter").append('<input type="hidden" name="is_thickbox" value="true">'),i(document).on("click",'[data-modularity-action="import"]',(function(t){t.preventDefault();var o=i(t.target).closest("tr").attr("id");o=o.split("-")[1];var e=n.a.isEditingModule(),a={action:"get_post",id:o};i("body").addClass("modularity-loader-takeover"),i.post(ajaxurl,a,(function(t){var o={post_id:t.ID,title:t.post_title};n.a.updateModule(e,o),d.a.save("form"),r.a.close()}),"json")}))),void("import-widget"==a.a.postAction&&(i('.check-column input[type="checkbox"]').remove(),i(".wp-list-table").addClass("modularity-wp-list-table"),i("tbody .check-column").addClass("modularity-import-column").append('<button class="button modularity-import-button" data-modularity-action="import">Import</button>'),i(document).on("click",'[data-modularity-action="import"]',(function(t){t.preventDefault();var o=i(t.target).closest("tr").attr("id");o=o.split("-")[1];var e=l.a.isEditingWidget(),a={action:"get_post",id:o};i("body").addClass("modularity-loader-takeover"),i.post(ajaxurl,a,(function(t){var o={post_id:t.ID,title:t.post_title};l.a.updateWidget(e,o),r.a.close()}),"json")})))))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2VkaXRvci90aGlja2JveC5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvcHJvbXB0L21vZGFsLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9lZGl0b3IvbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9lZGl0b3IvYXV0b3NhdmUuanMiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL2hlbHBlcnMvd2lkZ2V0LmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9oZWxwZXJzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL21vZHVsYXJpdHktZWRpdG9yLW1vZGFsLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiJCIsIlRoaWNrYm94IiwibW9kdWxlUG9zdENyZWF0ZWQiLCJwb3N0SWQiLCJNb2RhbCIsImNsb3NlIiwiTW9kdWxlIiwiaXNFZGl0aW5nTW9kdWxlIiwicmVxdWVzdCIsImFjdGlvbiIsImlkIiwicG9zdCIsImFqYXh1cmwiLCJyZXNwb25zZSIsImRhdGEiLCJwb3N0X2lkIiwiSUQiLCJ0aXRsZSIsInBvc3RfdGl0bGUiLCJ1cGRhdGVNb2R1bGUiLCJBdXRvc2F2ZSIsInNhdmUiLCJqUXVlcnkiLCJ0aGlzIiwiaGFuZGxlRXZlbnRzIiwib3BlbiIsInVybCIsImFkZENsYXNzIiwiYXBwZW5kIiwibW9kdWxhcml0eUFkbWluTGFuZ3VhZ2UiLCJyZW1vdmVDbGFzcyIsInJlbW92ZSIsImRvY3VtZW50Iiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJ0aGlja2JveE9wdGlvbnMiLCJpc190aGlja2JveCIsImVkaXRpbmdNb2R1bGUiLCJwYWdlbm93IiwibG9hZE1vZHVsZXMiLCJtb2R1bGFyaXR5X3Bvc3RfaWQiLCJlYWNoIiwic2lkZWJhciIsInNpZGViYXJFbGVtZW50IiwiaGlkZGVuIiwiaW5jb21wYWJpbGl0eSIsInNpZGViYXJfaW5jb21wYWJpbGl0eSIsImlzRW1wdHlPYmplY3QiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkTW9kdWxlIiwicG9zdF90eXBlIiwicG9zdF90eXBlX25hbWUiLCJjb2x1bW5XaWR0aCIsImlzRGVwcmVjYXRlZCIsImluaXRDb21wbGV0ZWQiLCJnZXRUaGlja0JveFVybCIsImJhc2UiLCJxdWVyeXN0cmluZyIsInBvc3RUeXBlIiwiYWRtaW5fdXJsIiwicGFyYW0iLCJnZXRJbXBvcnRVcmwiLCJ0YXJnZXQiLCJtb2R1bGVOYW1lIiwibW9kdWxlVGl0bGUiLCJkZXByZWNhdGVkIiwidGhpY2tib3hVcmwiLCJwb3N0QWN0aW9uIiwiaW1wb3J0VXJsIiwiaXNIaWRkZW4iLCJzaWRlYmFySWQiLCJpdGVtUm93SWQiLCJIZWxwZXJzIiwidXVpZCIsImh0bWwiLCJsYW5naGlkZSIsIndpZHRoIiwid2lkdGhPcHRpb25zIiwibGFuZ2VkaXQiLCJsYW5naW1wb3J0IiwibGFuZ3JlbW92ZSIsImluZGV4IiwiaXRlbSIsInZhbCIsImF0dHIiLCJzb3J0YWJsZSIsImZpbmQiLCJjaGFuZ2UiLCJ0ZXh0IiwicmVtb3ZlTW9kdWxlIiwiY29uZmlybSIsImFjdGlvblJlbW92ZSIsImNsb3Nlc3QiLCJpbmRleE9mIiwic2VsZWN0b3IiLCJjc3MiLCJzZXJpYWxpemVPYmplY3QiLCJlZGl0aW5nV2lkZ2V0IiwiV2lkZ2V0IiwicGFyZW50cyIsImlzRWRpdGluZ1dpZGdldCIsInVwZGF0ZVdpZGdldCIsIndpZGdldCIsInNlcGFyYXRvciIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsIm1vZHVsYXJpdHlfcG9zdF9hY3Rpb24iLCJwYXJlbnQiLCJsb2NhdGlvbiIsInJlbG9hZCIsInNwbGl0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9I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LElBQU9HLGFBQWFDLEVBQVExRixHQUM1QlYsSUFBTUMsVUFFUCIsImZpbGUiOiJqcy9tb2R1bGFyaXR5LWVkaXRvci1tb2RhbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNik7XG4iLCJpbXBvcnQgTW9kdWxlIGZyb20gJy4vbW9kdWxlLmpzJztcbmltcG9ydCBNb2RhbCBmcm9tICcuLi9wcm9tcHQvbW9kYWwuanMnO1xuaW1wb3J0IEF1dG9zYXZlIGZyb20gJy4vYXV0b3NhdmUuanMnO1xuXG4gZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgkKSB7XG5cbiAgICAvKipcbiAgICAgKiBBdHRlbnRpb246IFRoaXMgdmFyaWFibGUgc2hvdWxkIG5vdCBiZSBzZXQgbWFudWFsbHlcbiAgICAgKlxuICAgICAqIEluZGljYXRlcyBpZiB3ZSBhcmUgYWRkaW5nIGEgbmV3IHBvc3Qgb3IgZWRpdGluZyBvbGQgb25lXG4gICAgICogQHR5cGUge1N0cmluZ31cbiAgICAgKi9cbiAgICB2YXIgcG9zdEFjdGlvbiA9ICdhZGQnO1xuXG4gICAgZnVuY3Rpb24gVGhpY2tib3goKSB7XG5cbiAgICB9XG5cbiAgICBUaGlja2JveC5wcm90b3R5cGUubW9kdWxlUG9zdENyZWF0ZWQgPSBmdW5jdGlvbiAocG9zdElkKSB7XG4gICAgICAgIE1vZGFsLmNsb3NlKCk7XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9IE1vZHVsZS5pc0VkaXRpbmdNb2R1bGUoKTtcblxuICAgICAgICB2YXIgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgIGFjdGlvbjogJ2dldF9wb3N0JyxcbiAgICAgICAgICAgIGlkOiBwb3N0SWRcbiAgICAgICAgfTtcblxuICAgICAgICAkLnBvc3QoYWpheHVybCwgcmVxdWVzdCwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBwb3N0X2lkOiByZXNwb25zZS5JRCxcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVzcG9uc2UucG9zdF90aXRsZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgTW9kdWxlLnVwZGF0ZU1vZHVsZShtb2R1bGUsIGRhdGEpO1xuICAgICAgICAgICAgQXV0b3NhdmUuc2F2ZSgnZm9ybScpO1xuICAgICAgICB9LCAnanNvbicpO1xuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFRoaWNrYm94KCk7XG5cbn0pKGpRdWVyeSk7XG4iLCJleHBvcnQgZGVmYXVsdCAgKGZ1bmN0aW9uICgkKSB7XG5cbiAgICB2YXIgaXNPcGVuID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVFdmVudHMoKTtcbiAgICB9XG5cbiAgICBNb2RhbC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdtb2R1bGFyaXR5LW1vZGFsLW9wZW4nKS5hcHBlbmQoJ1xcXG4gICAgICAgICAgICA8ZGl2IGlkPVwibW9kdWxhcml0eS1tb2RhbFwiPlxcXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZHVsYXJpdHktbW9kYWwtd3JhcHBlclwiPlxcXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJtb2R1bGFyaXR5LW1vZGFsLWNsb3NlXCIgZGF0YS1tb2R1bGFyaXR5LW1vZGFsLWFjdGlvbj1cImNsb3NlXCI+JnRpbWVzOyAnICsgbW9kdWxhcml0eUFkbWluTGFuZ3VhZ2UuY2xvc2UgKyAnPC9idXR0b24+XFxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZHVsYXJpdHktbW9kYWwtc3Bpbm5lci1jb250YWluZXJcIiBpZD1cIm1vZHVsYXJpdHktaWZyYW1lLWxvYWRlclwiPjxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1tb2RhbC1zcGlubmVyXCI+PC9zcGFuPjwvZGl2PlxcXG4gICAgICAgICAgICAgICAgICAgIDxpZnJhbWUgY2xhc3M9XCJtb2R1bGFyaXR5LW1vZGFsLWlmcmFtZVwiIHNyYz1cIicgKyB1cmwgKyAnXCIgZnJhbWVib3JkZXI9XCIwXCIgb25sb2FkPVwiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXFwnbW9kdWxhcml0eS1pZnJhbWUtbG9hZGVyXFwnKS5zdHlsZS5kaXNwbGF5PVxcJ25vbmVcXCc7XCIgYWxsb3d0cmFuc3BhcmVuY3k+PC9pZnJhbWU+XFxcbiAgICAgICAgICAgICAgICA8L2Rpdj5cXFxuICAgICAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgJyk7XG5cbiAgICAgICAgaXNPcGVuID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgTW9kYWwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ21vZHVsYXJpdHktbW9kYWwtb3BlbicpO1xuICAgICAgICAkKCcjbW9kdWxhcml0eS1tb2RhbCcpLnJlbW92ZSgpO1xuICAgICAgICBpc09wZW4gPSBmYWxzZTtcbiAgICB9O1xuXG4gICAgTW9kYWwucHJvdG90eXBlLmhhbmRsZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLW1vZHVsYXJpdHktbW9kYWwtYWN0aW9uPVwiY2xvc2VcIl0nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IE1vZGFsKCk7XG5cbn0pKGpRdWVyeSk7XG4iLCJpbXBvcnQgVGhpY2tib3ggZnJvbSAnLi90aGlja2JveC5qcyc7XG5pbXBvcnQgSGVscGVycyBmcm9tICcuLi9oZWxwZXJzL2hlbHBlcnMuanMnO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uL3Byb21wdC9tb2RhbC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoJCkge1xuXG4gICAgdmFyIGluaXRDb21wbGV0ZWQgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIE9iamVjdCB0byBjcmVhdGUgVGhpY2tib3ggcXVlcnlzdHJpbmcgZnJvbVxuICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICovXG4gICAgdmFyIHRoaWNrYm94T3B0aW9ucyA9IHtcbiAgICAgICAgaXNfdGhpY2tib3g6IHRydWUsXG4gICAgfTtcblxuICAgIHZhciBlZGl0aW5nTW9kdWxlID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBNb2R1bGUoKSB7XG4gICAgICAgICQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFnZW5vdyAhPT0gJ3VuZGVmaW5lZCcgJiYgcGFnZW5vdyA9PSAnYWRtaW5fcGFnZV9tb2R1bGFyaXR5LWVkaXRvcicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUV2ZW50cygpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZE1vZHVsZXMobW9kdWxhcml0eV9wb3N0X2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyBzYXZlZCBtb2R1bGVzIGFuZCBhZGRzIHRoZW0gdG8gdGhlIHBhZ2VcbiAgICAgKiBAcGFyYW0gIHtpbnRlZ2VyfSBwb3N0SWQgVGhlIHBvc3QgaWQgdG8gbG9hZCBtb2R1bGVzIGZyb21cbiAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAqL1xuICAgIE1vZHVsZS5wcm90b3R5cGUubG9hZE1vZHVsZXMgPSBmdW5jdGlvbiAocG9zdElkKSB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgYWN0aW9uOiAnZ2V0X3Bvc3RfbW9kdWxlcycsXG4gICAgICAgICAgICBpZDogcG9zdElkXG4gICAgICAgIH07XG5cbiAgICAgICAgJC5wb3N0KGFqYXh1cmwsIHJlcXVlc3QsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgJC5lYWNoKHJlc3BvbnNlLCBmdW5jdGlvbiAoc2lkZWJhciwgbW9kdWxlcykge1xuICAgICAgICAgICAgICAgIHZhciBzaWRlYmFyRWxlbWVudCA9ICQoJy5tb2R1bGFyaXR5LXNpZGViYXItYXJlYVtkYXRhLWFyZWEtaWQ9XCInICsgc2lkZWJhciArICdcIl0nKTtcblxuICAgICAgICAgICAgICAgICQuZWFjaChtb2R1bGVzLm1vZHVsZXMsIGZ1bmN0aW9uIChrZXksIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaGlkZGVuID09ICd0cnVlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluY29tcGFiaWxpdHkgPSAodHlwZW9mIGRhdGEuc2lkZWJhcl9pbmNvbXBhYmlsaXR5ICE9ICd1bmRlZmluZWQnICYmICEkLmlzRW1wdHlPYmplY3QoZGF0YS5zaWRlYmFyX2luY29tcGFiaWxpdHkpKSA/IEpTT04uc3RyaW5naWZ5KGRhdGEuc2lkZWJhcl9pbmNvbXBhYmlsaXR5KSA6ICcnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZE1vZHVsZShzaWRlYmFyRWxlbWVudCwgZGF0YS5wb3N0X3R5cGUsIGRhdGEucG9zdF90eXBlX25hbWUsIGRhdGEucG9zdF90aXRsZSwgZGF0YS5JRCwgZGF0YS5oaWRkZW4sIGRhdGEuY29sdW1uV2lkdGgsIGRhdGEuaXNEZXByZWNhdGVkLCBpbmNvbXBhYmlsaXR5KTtcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgc2lkZWJhckVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21vZHVsYXJpdHktc3Bpbm5lcicpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5pbml0Q29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICQoJy5tb2R1bGFyaXR5LXNpZGViYXItYXJlYScpLnJlbW92ZUNsYXNzKCdtb2R1bGFyaXR5LXNwaW5uZXInKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAnanNvbicpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBlZGl0aW5nIG1vZHVsZVxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW4vc3RyaW5nfVxuICAgICAqL1xuICAgIE1vZHVsZS5wcm90b3R5cGUuaXNFZGl0aW5nTW9kdWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZWRpdGluZ01vZHVsZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGEgdGhpY2tib3ggdXJsIHRvIG9wZW4gYSB0aGlja2JveCBpbiBjb3JyZWN0IG1vZGVcbiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGFjdGlvbiBTaG91bGQgYmUgXCJhZGRcIiBvciBcImVkaXRcIlxuICAgICAqIEBwYXJhbSAge29iamVjdH0gZGF0YSAgIFNob3VsZCBjb250YWluIGFkZGl0aW9uYWwgZGF0YSAoZm9yIG5vdyBzdXBwb3J0cyBcInBvc3RJZFwiIGFuZCBcInBvc3RUeXBlXCIpXG4gICAgICogQHJldHVybiB7c3RyaW5nfSAgICAgICAgVGhpY2tib3ggdXJsXG4gICAgICovXG4gICAgTW9kdWxlLnByb3RvdHlwZS5nZXRUaGlja0JveFVybCA9IGZ1bmN0aW9uIChhY3Rpb24sIGRhdGEpIHtcbiAgICAgICAgdmFyIGJhc2UgPSAnJztcbiAgICAgICAgdmFyIHF1ZXJ5c3RyaW5nID0ge307XG5cbiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgYmFzZSA9ICdwb3N0LW5ldy5waHAnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlZGl0JzpcbiAgICAgICAgICAgICAgICBiYXNlID0gJ3Bvc3QucGhwJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgZGF0YS5wb3N0SWQgPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHF1ZXJ5c3RyaW5nLnBvc3QgPSBkYXRhLnBvc3RJZDtcbiAgICAgICAgICAgIHF1ZXJ5c3RyaW5nLmFjdGlvbiA9ICdlZGl0JztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgZGF0YS5wb3N0VHlwZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcXVlcnlzdHJpbmcucG9zdF90eXBlID0gZGF0YS5wb3N0VHlwZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhZG1pbl91cmwgKyBiYXNlICsgJz8nICsgJC5wYXJhbShxdWVyeXN0cmluZykgKyAnJicgKyAkLnBhcmFtKHRoaWNrYm94T3B0aW9ucyk7XG4gICAgfTtcblxuICAgIE1vZHVsZS5wcm90b3R5cGUuZ2V0SW1wb3J0VXJsID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIGJhc2UgPSAnZWRpdC5waHAnO1xuICAgICAgICB2YXIgcXVlcnlzdHJpbmcgPSB7fTtcblxuICAgICAgICBxdWVyeXN0cmluZy5wb3N0X3R5cGUgPSBkYXRhLnBvc3RUeXBlO1xuXG4gICAgICAgIHJldHVybiBhZG1pbl91cmwgKyBiYXNlICsgJz8nICsgJC5wYXJhbShxdWVyeXN0cmluZykgKyAnJicgKyAkLnBhcmFtKHRoaWNrYm94T3B0aW9ucyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBtb2R1bGUgXCJyb3dcIiB0byB0aGUgdGFyZ2V0IHBsYWNlaG9sZGVyXG4gICAgICogQHBhcmFtIHtzZWxlY3Rvcn0gdGFyZ2V0ICAgVGhlIHRhcmdldCBzZWxlY3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2R1bGVJZCAgIFRoZSBtb2R1bGUgaWQgc2x1Z1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2R1bGVOYW1lIFRoZSBtb2R1bGUgbmFtZVxuICAgICAqL1xuICAgIE1vZHVsZS5wcm90b3R5cGUuYWRkTW9kdWxlID0gZnVuY3Rpb24gKHRhcmdldCwgbW9kdWxlSWQsIG1vZHVsZU5hbWUsIG1vZHVsZVRpdGxlLCBwb3N0SWQsIGhpZGRlbiwgY29sdW1uV2lkdGgsIGlzRGVwcmVjYXRlZCwgaW5jb21wYWJpbGl0eSkge1xuICAgICAgICBtb2R1bGVUaXRsZSA9ICh0eXBlb2YgbW9kdWxlVGl0bGUgIT0gJ3VuZGVmaW5lZCcpID8gJzogJyArIG1vZHVsZVRpdGxlIDogJyc7XG4gICAgICAgIHBvc3RJZCA9ICh0eXBlb2YgcG9zdElkICE9ICd1bmRlZmluZWQnKSA/IHBvc3RJZCA6ICcnO1xuICAgICAgICBjb2x1bW5XaWR0aCA9ICh0eXBlb2YgY29sdW1uV2lkdGggIT0gJ3VuZGVmaW5lZCcpID8gY29sdW1uV2lkdGggOiAnJztcbiAgICAgICAgY29uc3QgZGVwcmVjYXRlZCA9IChpc0RlcHJlY2F0ZWQgPT09IHRydWUpID8gJzxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1kZXByZWNhdGVkXCInICtcbiAgICAgICAgICAgICcgc3R5bGU9XCJjb2xvcjojZmYwMDAwO1wiPignICsgbW9kdWxhcml0eUFkbWluTGFuZ3VhZ2UuZGVwcmVjYXRlZCArICcpPC9zcGFuPicgOiAnJztcbiAgICAgICAgaW5jb21wYWJpbGl0eSA9ICh0eXBlb2YgaW5jb21wYWJpbGl0eSAhPSAndW5kZWZpbmVkJykgPyBpbmNvbXBhYmlsaXR5IDogJyc7XG5cbiAgICAgICAgLy8gR2V0IHRoaWNrYm94IHVybFxuICAgICAgICB2YXIgdGhpY2tib3hVcmwgPSB0aGlzLmdldFRoaWNrQm94VXJsKCdhZGQnLCB7XG4gICAgICAgICAgICBwb3N0VHlwZTogbW9kdWxlSWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU2V0IHRoaWNrYm94IGFjdGlvblxuICAgICAgICBUaGlja2JveC5wb3N0QWN0aW9uID0gJ2FkZCc7XG5cbiAgICAgICAgaWYgKHBvc3RJZCkge1xuICAgICAgICAgICAgdGhpY2tib3hVcmwgPSB0aGlzLmdldFRoaWNrQm94VXJsKCdlZGl0Jywge1xuICAgICAgICAgICAgICAgIHBvc3RJZDogcG9zdElkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgVGhpY2tib3gucG9zdEFjdGlvbiA9ICdlZGl0JztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBpbXBvcnQgdXJsXG4gICAgICAgIHZhciBpbXBvcnRVcmwgPSB0aGlzLmdldEltcG9ydFVybCh7XG4gICAgICAgICAgICBwb3N0VHlwZTogbW9kdWxlSWRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2hlY2svdW5jaGVjayBoaWRkZW4gY2hlY2tib3hcbiAgICAgICAgdmFyIGlzSGlkZGVuID0gJyc7XG4gICAgICAgIGlmIChoaWRkZW4gPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlzSGlkZGVuID0gJ2NoZWNrZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNpZGViYXJJZCA9ICQodGFyZ2V0KS5kYXRhKCdhcmVhLWlkJyk7XG4gICAgICAgIHZhciBpdGVtUm93SWQgPSBIZWxwZXJzLnV1aWQoKTtcblxuICAgICAgICB2YXIgaHRtbCA9ICc8bGkgaWQ9XCJwb3N0LScgKyBwb3N0SWQgKyAnXCIgZGF0YS1tb2R1bGUtaWQ9XCInICsgbW9kdWxlSWQgKyAnXCIgZGF0YS1tb2R1bGUtc3RvcmVkLXdpZHRoPVwiJyArIGNvbHVtbldpZHRoICsgJ1wiIGRhdGEtc2lkZWJhci1pbmNvbXBhYmlsaXR5PVxcJycgKyBpbmNvbXBhYmlsaXR5ICsgJ1xcJz5cXFxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1saW5lLXdyYXBwZXJcIj5cXFxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vZHVsYXJpdHktc29ydGFibGUtaGFuZGxlXCI+PC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1tb2R1bGUtbmFtZVwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAnICsgbW9kdWxlTmFtZSArICdcXFxuICAgICAgICAgICAgICAgICAgICAgICAgJyArIGRlcHJlY2F0ZWQgKyAnXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1tb2R1bGUtdGl0bGVcIj4nICsgbW9kdWxlVGl0bGUgKyAnPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9XCJtb2R1bGFyaXR5LW1vZHVsZS1oaWRlXCI+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmFtZT1cIm1vZHVsYXJpdHlfbW9kdWxlc1snICsgc2lkZWJhcklkICsgJ11bJyArIGl0ZW1Sb3dJZCArICddW2hpZGRlbl1cIiB2YWx1ZT1cImhpZGRlblwiICcgKyBpc0hpZGRlbiArICcgLz5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgKyBtb2R1bGFyaXR5QWRtaW5MYW5ndWFnZS5sYW5naGlkZSArICdcXFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cXFxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XFxcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtb2R1bGFyaXR5LW1vZHVsZS1jb2x1bW5zXCI+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD4nICsgbW9kdWxhcml0eUFkbWluTGFuZ3VhZ2Uud2lkdGggKyAnOjwvbGFiZWw+XFxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgbmFtZT1cIm1vZHVsYXJpdHlfbW9kdWxlc1snICsgc2lkZWJhcklkICsgJ11bJyArIGl0ZW1Sb3dJZCArICddW2NvbHVtbldpZHRoXVwiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyArIG1vZHVsYXJpdHlBZG1pbkxhbmd1YWdlLndpZHRoT3B0aW9ucyArICdcXFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XFxcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kdWxhcml0eS1tb2R1bGUtYWN0aW9uc1wiPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJyArIHRoaWNrYm94VXJsICsgJ1wiIGRhdGEtbW9kdWxhcml0eS1tb2RhbCBjbGFzcz1cIm1vZHVsYXJpdHktanMtdGhpY2tib3gtb3BlblwiPjxzcGFuPicgKyBtb2R1bGFyaXR5QWRtaW5MYW5ndWFnZS5sYW5nZWRpdCArICc8L3NwYW4+PC9hPlxcXG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJyArIGltcG9ydFVybCArICdcIiBjbGFzcz1cIm1vZHVsYXJpdHktanMtdGhpY2tib3gtaW1wb3J0XCI+PHNwYW4+JyArIG1vZHVsYXJpdHlBZG1pbkxhbmd1YWdlLmxhbmdpbXBvcnQgKyAnPC9zcGFuPjwvYT5cXFxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNyZW1vdmVcIiBjbGFzcz1cIm1vZHVsYXJpdHktbW9kdWxlLXJlbW92ZVwiPjxzcGFuPicgKyBtb2R1bGFyaXR5QWRtaW5MYW5ndWFnZS5sYW5ncmVtb3ZlICsgJzwvc3Bhbj48L2E+XFxcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cIm1vZHVsYXJpdHlfbW9kdWxlc1snICsgc2lkZWJhcklkICsgJ11bJyArIGl0ZW1Sb3dJZCArICddW3Bvc3RpZF1cIiBjbGFzcz1cIm1vZHVsYXJpdHktanMtbW9kdWxlLWlkXCIgdmFsdWU9XCInICsgcG9zdElkICsgJ1wiIHJlcXVpcmVkPlxcXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxcXG4gICAgICAgICAgICA8L2xpPic7XG5cbiAgICAgICAgLy9TdG9yZVxuICAgICAgICAkKHRhcmdldCkuYXBwZW5kKGh0bWwpO1xuXG4gICAgICAgIC8vVXBkYXRlIHdpZHRoIHNlbGVjdG9yXG4gICAgICAgICQoJy5tb2R1bGFyaXR5LXNpZGViYXItYXJlYSA+IGxpJykuZWFjaChmdW5jdGlvbihpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgJCgnLm1vZHVsYXJpdHktbW9kdWxlLWNvbHVtbnMgc2VsZWN0JywgJChpdGVtKSkudmFsKCQoaXRlbSkuYXR0cignZGF0YS1tb2R1bGUtc3RvcmVkLXdpZHRoJykpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL1JlZnJlc2hcbiAgICAgICAgJCgnLm1vZHVsYXJpdHktanMtc29ydGFibGUnKS5zb3J0YWJsZSgncmVmcmVzaCcpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIGEgbW9kdWxlIFwicm93XCIgYWZ0ZXIgZWRpdGluZyB0aGUgbW9kdWxlIHBvc3RcbiAgICAgKiBAcGFyYW0gIHtET019IG1vZHVsZSAgICBNb2R1bGUgZG9tIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0gIHtvYmplY3R9IGRhdGEgICBUaGUgZGF0YVxuICAgICAqIEByZXR1cm4ge3ZvaWR9XG4gICAgICovXG4gICAgTW9kdWxlLnByb3RvdHlwZS51cGRhdGVNb2R1bGUgPSBmdW5jdGlvbiAobW9kdWxlLCBkYXRhKSB7XG4gICAgICAgIC8vIEhyZWZcbiAgICAgICAgbW9kdWxlLmZpbmQoJ2EubW9kdWxhcml0eS1qcy10aGlja2JveC1vcGVuJykuYXR0cignaHJlZicsIHRoaXMuZ2V0VGhpY2tCb3hVcmwoJ2VkaXQnLCB7XG4gICAgICAgICAgICBwb3N0SWQ6IGRhdGEucG9zdF9pZFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gUG9zdCBpZCBpbnB1dFxuICAgICAgICBtb2R1bGUuZmluZCgnaW5wdXQubW9kdWxhcml0eS1qcy1tb2R1bGUtaWQnKS52YWwoZGF0YS5wb3N0X2lkKS5jaGFuZ2UoKTtcblxuICAgICAgICAvLyBQb3N0IHRpdGxlXG4gICAgICAgIG1vZHVsZS5maW5kKCcubW9kdWxhcml0eS1tb2R1bGUtdGl0bGUnKS50ZXh0KCc6ICcgKyBkYXRhLnRpdGxlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIG1vZHVsZSBcInJvd1wiIGZyb20gdGhlIHBsYWNlaG9sZGVyXG4gICAgICogQHBhcmFtICB7RE9NIEVsZW1lbnR9IG1vZHVsZSBUaGUgKHRvIGJlIHJlbW92ZWQpIG1vZHVsZSdzIGRvbSBlbGVtZW50XG4gICAgICogQHJldHVybiB7dm9pZH1cbiAgICAgKi9cbiAgICBNb2R1bGUucHJvdG90eXBlLnJlbW92ZU1vZHVsZSA9IGZ1bmN0aW9uIChtb2R1bGUpIHtcbiAgICAgICAgaWYgKGNvbmZpcm0obW9kdWxhcml0eUFkbWluTGFuZ3VhZ2UuYWN0aW9uUmVtb3ZlKSkge1xuICAgICAgICAgICAgbW9kdWxlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBldmVudHNcbiAgICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgICAqL1xuICAgIE1vZHVsZS5wcm90b3R5cGUuaGFuZGxlRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIFRyYXNoIGljb25cbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5tb2R1bGFyaXR5LW1vZHVsZS1yZW1vdmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2xpJyk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZU1vZHVsZSh0YXJnZXQpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgIC8vSW1wb3J0XG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcubW9kdWxhcml0eS1qcy10aGlja2JveC1pbXBvcnQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICB2YXIgZWwgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdhJyk7XG4gICAgICAgICAgICBlZGl0aW5nTW9kdWxlID0gJChlLnRhcmdldCkuY2xvc2VzdCgnbGknKTtcblxuICAgICAgICAgICAgVGhpY2tib3gucG9zdEFjdGlvbiA9ICdpbXBvcnQnO1xuICAgICAgICAgICAgTW9kYWwub3BlbigkKGUudGFyZ2V0KS5jbG9zZXN0KCdhJykuYXR0cignaHJlZicpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRWRpdFxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLm1vZHVsYXJpdHktanMtdGhpY2tib3gtb3BlbicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIHZhciBlbCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKTtcbiAgICAgICAgICAgIGlmIChlbC5hdHRyKCdocmVmJykuaW5kZXhPZigncG9zdC5waHAnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgVGhpY2tib3gucG9zdEFjdGlvbiA9ICdlZGl0JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZWRpdGluZ01vZHVsZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2xpJyk7XG4gICAgICAgICAgICBNb2RhbC5vcGVuKCQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKS5hdHRyKCdocmVmJykpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgTW9kdWxlKCk7XG5cbn0pKGpRdWVyeSk7XG4iLCJleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKCQpIHtcblxuICAgIGZ1bmN0aW9uIEF1dG9zYXZlKCkge1xuICAgICAgICAkKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvL3RoaXMuaGFuZGxlRXZlbnRzKCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgQXV0b3NhdmUucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICAgICAgJCgnI21vZHVsYXJpdHktb3B0aW9ucyAjcHVibGlzaGluZy1hY3Rpb24gLnNwaW5uZXInKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgICB2YXIgcmVxdWVzdCA9ICQoc2VsZWN0b3IpLnNlcmlhbGl6ZU9iamVjdCgpO1xuICAgICAgICByZXF1ZXN0LmlkID0gbW9kdWxhcml0eV9wb3N0X2lkO1xuICAgICAgICByZXF1ZXN0LmFjdGlvbiA9ICdzYXZlX21vZHVsZXMnO1xuXG4gICAgICAgICQucG9zdChhamF4dXJsLCByZXF1ZXN0LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICQoJyNtb2R1bGFyaXR5LW9wdGlvbnMgI3B1Ymxpc2hpbmctYWN0aW9uIC5zcGlubmVyJykuY3NzKCd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBBdXRvc2F2ZSgpO1xuXG59KShqUXVlcnkpO1xuIiwiaW1wb3J0IFRoaWNrYm94IGZyb20gJy4uL2VkaXRvci90aGlja2JveC5qcyc7XG5pbXBvcnQgTW9kdWxlIGZyb20gJy4uL2VkaXRvci9tb2R1bGUuanMnO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uL3Byb21wdC9tb2RhbC5qcyc7XG5cblxuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgkKSB7XG5cbiAgICB2YXIgZWRpdGluZ1dpZGdldCA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gV2lkZ2V0KCkge1xuICAgICAgICAkKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIC8qIEltcG9ydCAqL1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5tb2R1bGFyaXR5LWpzLXRoaWNrYm94LXdpZGdldC1pbXBvcnQtd2lkZ2V0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBlZGl0aW5nV2lkZ2V0ID0gJChlLnRhcmdldCkucGFyZW50cygnLndpZGdldC1pbnNpZGUnKTtcblxuICAgICAgICAgICAgICAgIHZhciBpbXBvcnRVcmwgPSBNb2R1bGUuZ2V0SW1wb3J0VXJsKHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdFR5cGU6ICQoZS50YXJnZXQpLnBhcmVudHMoJy53aWRnZXQtaW5zaWRlJykuZmluZCgnLm1vZHVsYXJpdHktd2lkZ2V0LW1vZHVsZS10eXBlIHNlbGVjdCcpLnZhbCgpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBNb2R1bGUuZWRpdGluZ01vZHVsZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy53aWRnZXQtaW5zaWRlJyk7XG5cbiAgICAgICAgICAgICAgICBUaGlja2JveC5wb3N0QWN0aW9uID0gJ2ltcG9ydC13aWRnZXQnO1xuICAgICAgICAgICAgICAgIE1vZGFsLm9wZW4oaW1wb3J0VXJsKTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIC8qIEVkaXQgKi9cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcubW9kdWxhcml0eS1qcy10aGlja2JveC1vcGVuLXdpZGdldCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGVsID0gJChlLnRhcmdldCkuY2xvc2VzdCgnYScpO1xuICAgICAgICAgICAgICAgIGlmIChlbC5hdHRyKCdocmVmJykuaW5kZXhPZigncG9zdC5waHAnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIFRoaWNrYm94LnBvc3RBY3Rpb24gPSAnZWRpdCc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgZWRpdGluZ01vZHVsZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2xpJyk7XG5cbiAgICAgICAgICAgICAgICBNb2RhbC5vcGVuKCQoZS50YXJnZXQpLmNsb3Nlc3QoJ2EnKS5hdHRyKCdocmVmJykpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgV2lkZ2V0LnByb3RvdHlwZS5pc0VkaXRpbmdXaWRnZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBlZGl0aW5nV2lkZ2V0O1xuICAgIH07XG5cbiAgICBXaWRnZXQucHJvdG90eXBlLnVwZGF0ZVdpZGdldCA9IGZ1bmN0aW9uICh3aWRnZXQsIGRhdGEpIHtcbiAgICAgICAgJCh3aWRnZXQpLmZpbmQoJy5tb2R1bGFyaXR5LXdpZGdldC1tb2R1bGUtaWQtc3BhbicpLmh0bWwoZGF0YS5wb3N0X2lkKTtcbiAgICAgICAgJCh3aWRnZXQpLmZpbmQoJy5tb2R1bGFyaXR5LXdpZGdldC1tb2R1bGUtaWQnKS52YWwoZGF0YS5wb3N0X2lkKTtcbiAgICAgICAgJCh3aWRnZXQpLmZpbmQoJy5tb2R1bGFyaXR5LXdpZGdldC1tb2R1bGUtZWRpdCcpLmF0dHIoJ2hyZWYnLCdwb3N0LnBocD9wb3N0PScgKyBkYXRhLnBvc3RfaWQgKyAnJmFjdGlvbj1lZGl0JmlzX3RoaWNrYm94PXRydWUnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICQod2lkZ2V0KS5maW5kKCcubW9kdWxhcml0eS13aWRnZXQtbW9kdWxlLXRpdGxlLXNwYW4nKS5odG1sKGRhdGEudGl0bGUpO1xuICAgICAgICAkKHdpZGdldCkuZmluZCgnLm1vZHVsYXJpdHktd2lkZ2V0LW1vZHVsZS10aXRsZScpLnZhbChkYXRhLnRpdGxlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBXaWRnZXQoKTtcblxufSkoalF1ZXJ5KTtcbiIsImV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoJCkge1xuXG4gICAgZnVuY3Rpb24gSGVscGVycygpIHtcbiAgICAgICAgJChmdW5jdGlvbigpe1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIEhlbHBlcnMucHJvdG90eXBlLnV1aWQgPSBmdW5jdGlvbiAoc2VwYXJhdG9yKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSk7XG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgSGVscGVycygpO1xuXG59KShqUXVlcnkpO1xuIiwiaW1wb3J0IFRoaWNrYm94IGZyb20gJy4vZWRpdG9yL3RoaWNrYm94LmpzJztcbmltcG9ydCBNb2R1bGUgZnJvbSAnLi9lZGl0b3IvbW9kdWxlLmpzJztcbmltcG9ydCBBdXRvc2F2ZSBmcm9tICcuL2VkaXRvci9hdXRvc2F2ZS5qcyc7XG5pbXBvcnQgTW9kYWwgZnJvbSAnLi9wcm9tcHQvbW9kYWwuanMnO1xuaW1wb3J0IFdpZGdldCBmcm9tICcuL2hlbHBlcnMvd2lkZ2V0LmpzJztcblxuZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgkKSB7XG4gICAgLyoqXG4gICAgICogQWRkIG5ldyBwb3N0IGNhbGxiYWNrXG4gICAgICovXG4gICAgaWYgKFRoaWNrYm94LnBvc3RBY3Rpb24gPT0gJ2FkZCcgJiYgbW9kdWxhcml0eV9wb3N0X2FjdGlvbiA9PSAnJykge1xuICAgICAgICBUaGlja2JveC5tb2R1bGVQb3N0Q3JlYXRlZChtb2R1bGFyaXR5X3Bvc3RfaWQpO1xuICAgIH1cbiAgICBcbiAgICBpZiAoVGhpY2tib3gucG9zdEFjdGlvbiA9PSAnZWRpdC1pbmxpbmUtc2F2ZWQnKSB7XG4gICAgICAgIHBhcmVudC5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRWRpdCBwb3N0IGNhbGxiYWNrXG4gICAgICovXG4gICAgaWYgKFRoaWNrYm94LnBvc3RBY3Rpb24gPT0gJ2VkaXQnICYmIG1vZHVsYXJpdHlfcG9zdF9hY3Rpb24gPT0gJycpIHtcbiAgICAgICAgalF1ZXJ5KGRvY3VtZW50KS5vbignY2xpY2snLCAnI3B1Ymxpc2gnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgVGhpY2tib3gucG9zdEFjdGlvbiA9ICdhZGQnO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogRWRpdCBwb3N0IGNhbGxiYWNrXG4gICAgICovXG4gICAgaWYgKFRoaWNrYm94LnBvc3RBY3Rpb24gPT0gJ2VkaXQtaW5saW5lLW5vdC1zYXZlZCcpIHtcbiAgICAgICAgalF1ZXJ5KGRvY3VtZW50KS5vbignY2xpY2snLCAnI3B1Ymxpc2gnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgVGhpY2tib3gucG9zdEFjdGlvbiA9ICdlZGl0LWlubGluZS1zYXZlZCc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBJbXBvcnQgcG9zdCBtb2RpZmljYXRpb25zIGFuZCBjYWxsYmFja1xuICAgICAqL1xuICAgIGlmIChUaGlja2JveC5wb3N0QWN0aW9uID09ICdpbXBvcnQnKSB7XG4gICAgICAgICQoJy5jaGVjay1jb2x1bW4gaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykucmVtb3ZlKCk7XG4gICAgICAgICQoJy53cC1saXN0LXRhYmxlJykuYWRkQ2xhc3MoJ21vZHVsYXJpdHktd3AtbGlzdC10YWJsZScpO1xuICAgICAgICAkKCd0Ym9keSAuY2hlY2stY29sdW1uJykuYWRkQ2xhc3MoJ21vZHVsYXJpdHktaW1wb3J0LWNvbHVtbicpLmFwcGVuZCgnPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiBtb2R1bGFyaXR5LWltcG9ydC1idXR0b25cIiBkYXRhLW1vZHVsYXJpdHktYWN0aW9uPVwiaW1wb3J0XCI+SW1wb3J0PC9idXR0b24+Jyk7XG4gICAgICAgICQoJyNwb3N0cy1maWx0ZXInKS5hcHBlbmQoJzxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cImlzX3RoaWNrYm94XCIgdmFsdWU9XCJ0cnVlXCI+Jyk7XG4gICAgICAgIFxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtbW9kdWxhcml0eS1hY3Rpb249XCJpbXBvcnRcIl0nLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcG9zdElkID0gJChlLnRhcmdldCkuY2xvc2VzdCgndHInKS5hdHRyKCdpZCcpO1xuICAgICAgICAgICAgcG9zdElkID0gcG9zdElkLnNwbGl0KCctJylbMV07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBtb2R1bGUgPSBNb2R1bGUuaXNFZGl0aW5nTW9kdWxlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ2dldF9wb3N0JyxcbiAgICAgICAgICAgICAgICBpZDogcG9zdElkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ21vZHVsYXJpdHktbG9hZGVyLXRha2VvdmVyJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQucG9zdChhamF4dXJsLCByZXF1ZXN0LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdF9pZDogcmVzcG9uc2UuSUQsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiByZXNwb25zZS5wb3N0X3RpdGxlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBNb2R1bGUudXBkYXRlTW9kdWxlKG1vZHVsZSwgZGF0YSk7XG4gICAgICAgICAgICAgICAgQXV0b3NhdmUuc2F2ZSgnZm9ybScpO1xuICAgICAgICAgICAgICAgIE1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICB9LCAnanNvbicpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogSW1wb3J0IHBvc3QgbW9kaWZpY2F0aW9ucyBhbmQgY2FsbGJhY2tcbiAgICAgKi9cbiAgICBpZiAoVGhpY2tib3gucG9zdEFjdGlvbiA9PSAnaW1wb3J0LXdpZGdldCcpIHtcbiAgICAgICAgJCgnLmNoZWNrLWNvbHVtbiBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKS5yZW1vdmUoKTtcbiAgICAgICAgJCgnLndwLWxpc3QtdGFibGUnKS5hZGRDbGFzcygnbW9kdWxhcml0eS13cC1saXN0LXRhYmxlJyk7XG4gICAgICAgICQoJ3Rib2R5IC5jaGVjay1jb2x1bW4nKS5hZGRDbGFzcygnbW9kdWxhcml0eS1pbXBvcnQtY29sdW1uJykuYXBwZW5kKCc8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIG1vZHVsYXJpdHktaW1wb3J0LWJ1dHRvblwiIGRhdGEtbW9kdWxhcml0eS1hY3Rpb249XCJpbXBvcnRcIj5JbXBvcnQ8L2J1dHRvbj4nKTtcbiAgICAgICAgXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1tb2R1bGFyaXR5LWFjdGlvbj1cImltcG9ydFwiXScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBwb3N0SWQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCd0cicpLmF0dHIoJ2lkJyk7XG4gICAgICAgICAgICBwb3N0SWQgPSBwb3N0SWQuc3BsaXQoJy0nKVsxXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHdpZGdldCA9IFdpZGdldC5pc0VkaXRpbmdXaWRnZXQoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZ2V0X3Bvc3QnLFxuICAgICAgICAgICAgICAgIGlkOiBwb3N0SWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnbW9kdWxhcml0eS1sb2FkZXItdGFrZW92ZXInKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5wb3N0KGFqYXh1cmwsIHJlcXVlc3QsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBwb3N0X2lkOiByZXNwb25zZS5JRCxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHJlc3BvbnNlLnBvc3RfdGl0bGVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFdpZGdldC51cGRhdGVXaWRnZXQod2lkZ2V0LCBkYXRhKTtcbiAgICAgICAgICAgICAgICBNb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSwgJ2pzb24nKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxufSkoalF1ZXJ5KTtcblxuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=