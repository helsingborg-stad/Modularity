!function(t){var e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=4)}({4:function(t,e){var o=o||{};o.Posts=o.Posts||{},o.Posts.LoadMoreButton=function(t){function e(){this.init()}return e.prototype.init=function(){t(document).on("click",".js-mod-posts-load-more",function(e){var o=t(e.target).closest(".js-mod-posts-load-more"),r=JSON.parse(window.atob(o.attr("data-mod-posts-load-more")));if(this.attributesExists(["postsPerPage","offset","target","ajaxUrl","nonce","bladeTemplate"],Object.keys(r))){var n=t(r.target)[0];if(void 0===n)throw'Error: Could not find target "'+r.target+'"';this.toggleLoader(o),this.loadMorePosts(o,n,r)}}.bind(this))},e.prototype.toggleLoader=function(t){if(t.hasClass("hidden"))return t.removeClass("hidden"),void this.removeLoader(t);t.addClass("hidden"),t.after('<div class="loading"><div></div><div></div><div></div><div></div></div>')},e.prototype.loadMorePosts=function(e,o,r){var n=r;n.action="mod_posts_load_more",t.ajax({type:"post",url:n.ajaxUrl,data:n,dataType:"html",success:function(n,i){return"success"===i?(t(o).append(JSON.parse(n)),r.postsPerPage>n.length?(this.removeLoader(e),void e.remove()):(this.toggleLoader(e),r.offset=parseInt(r.offset)+parseInt(r.postsPerPage),void e.attr("data-mod-posts-load-more",window.btoa(JSON.stringify(r))))):"nocontent"===i?(this.removeLoader(e),e.after("<p>No more posts to showâ€¦</p>"),void e.remove()):void 0}.bind(this),error:function(t,e,o){console.log(o)}})},e.prototype.removeLoader=function(e){t(e.next()).hasClass("loading")&&e.next().remove()},e.prototype.attributesExists=function(t,e){var o=!0;return t.forEach((function(t){if(!e.includes(t))throw o=!1,'ValidationError: Missing required data-attribute key "'+t+'"'})),o},new e}(jQuery)}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL3BocC9Nb2R1bGUvUG9zdHMvYXNzZXRzL21vZC1wb3N0cy1sb2FkLW1vcmUtYnV0dG9uLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiTW9kdWxhcml0eSIsIlBvc3RzIiwiTG9hZE1vcmVCdXR0b24iLCIkIiwidGhpcyIsImluaXQiLCJkb2N1bWVudCIsIm9uIiwiZSIsImJ1dHRvbiIsInRhcmdldCIsImNsb3Nlc3QiLCJhdHRyaWJ1dGVzIiwiSlNPTiIsInBhcnNlIiwid2luZG93IiwiYXRvYiIsImF0dHIiLCJhdHRyaWJ1dGVzRXhpc3RzIiwia2V5cyIsInRvZ2dsZUxvYWRlciIsImxvYWRNb3JlUG9zdHMiLCJoYXNDbGFzcyIsInJlbW92ZUNsYXNzIiwicmVtb3ZlTG9hZGVyIiwiYWRkQ2xhc3MiLCJhZnRlciIsImRhdGEiLCJhY3Rpb24iLCJhamF4IiwidHlwZSIsInVybCIsImFqYXhVcmwiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJwb3N0cyIsInN0YXR1cyIsImFwcGVuZCIsInBvc3RzUGVyUGFnZSIsImxlbmd0aCIsInJlbW92ZSIsIm9mZnNldCIsInBhcnNlSW50IiwiYnRvYSIsInN0cmluZ2lmeSIsImVycm9yIiwianFYSFIiLCJjb25zb2xlIiwibG9nIiwibmV4dCIsInJlcXVpcmVkS2V5cyIsImF0dHJpYnV0ZUtleXMiLCJleGlzdHMiLCJmb3JFYWNoIiwiaW5jbHVkZXMiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVks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RyxTQUFTL0QsR0FHeEIsTUFGQTZELEdBQVMsRUFFSCx5REFBMkQ3RCxFQUFNLE9BSXhFNkQsR0FHSixJQUFJbEQsRUF2SG9CLENBeUhoQ3FEIiwiZmlsZSI6ImpzL21vZC1wb3N0cy1sb2FkLW1vcmUtYnV0dG9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0KTtcbiIsInZhciBNb2R1bGFyaXR5ID0gTW9kdWxhcml0eSB8fCB7fTtcbk1vZHVsYXJpdHkuUG9zdHMgPSBNb2R1bGFyaXR5LlBvc3RzIHx8IHt9O1xuXG5Nb2R1bGFyaXR5LlBvc3RzLkxvYWRNb3JlQnV0dG9uID0gKGZ1bmN0aW9uICgkKSB7XG4gICAgZnVuY3Rpb24gTG9hZE1vcmVCdXR0b24oKSB7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cblxuICAgIExvYWRNb3JlQnV0dG9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuanMtbW9kLXBvc3RzLWxvYWQtbW9yZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBidXR0b24gPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCcuanMtbW9kLXBvc3RzLWxvYWQtbW9yZScpO1xuICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gSlNPTi5wYXJzZSh3aW5kb3cuYXRvYihidXR0b24uYXR0cignZGF0YS1tb2QtcG9zdHMtbG9hZC1tb3JlJykpKTtcbiAgICAgICAgICAgIC8vTWFrZSBzdXJlIHJlcXVpcmVkIGF0dHJpYnV0ZXMgZXhpc3RzXG4gICAgICAgICAgICB2YXIgcmVxdWlyZWRLZXlzID0gWydwb3N0c1BlclBhZ2UnLCAnb2Zmc2V0JywgJ3RhcmdldCcsICdhamF4VXJsJywgJ25vbmNlJywgJ2JsYWRlVGVtcGxhdGUnXTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hdHRyaWJ1dGVzRXhpc3RzKHJlcXVpcmVkS2V5cywgT2JqZWN0LmtleXMoYXR0cmlidXRlcykpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL01ha2Ugc3VyZSB0YXJnZXQgZXhpc3RzXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gJChhdHRyaWJ1dGVzLnRhcmdldClbMF07XG4gICAgICAgICAgICBpZiAodHlwZW9mKHRhcmdldCkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgJ0Vycm9yOiBDb3VsZCBub3QgZmluZCB0YXJnZXQgXCInICsgYXR0cmlidXRlcy50YXJnZXQgKyAnXCInO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50b2dnbGVMb2FkZXIoYnV0dG9uKTtcbiAgICAgICAgICAgIHRoaXMubG9hZE1vcmVQb3N0cyhidXR0b24sIHRhcmdldCwgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9O1xuXG4gICAgTG9hZE1vcmVCdXR0b24ucHJvdG90eXBlLnRvZ2dsZUxvYWRlciA9IGZ1bmN0aW9uKGJ1dHRvbilcbiAgICB7XG4gICAgICAgIGlmIChidXR0b24uaGFzQ2xhc3MoJ2hpZGRlbicpKSB7XG4gICAgICAgICAgICBidXR0b24ucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUxvYWRlcihidXR0b24pO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBidXR0b24uYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgIC8vQ3JlYXRlIGxvYWRlclxuICAgICAgICBidXR0b24uYWZ0ZXIoJzxkaXYgY2xhc3M9XCJsb2FkaW5nXCI+PGRpdj48L2Rpdj48ZGl2PjwvZGl2PjxkaXY+PC9kaXY+PGRpdj48L2Rpdj48L2Rpdj4nKTtcbiAgICB9O1xuICAgIFxuICAgIC8qKlxuICAgICAqIExvYWQgbW9yZSBwb3N0c1xuICAgICAqIEBwYXJhbSBidXR0b25cbiAgICAgKiBAcGFyYW0gdGFyZ2V0XG4gICAgICogQHBhcmFtIGF0dHJpYnV0ZXNcbiAgICAgKiBAcGFyYW0gcmF3ZGF0YVxuICAgICAqL1xuICAgIExvYWRNb3JlQnV0dG9uLnByb3RvdHlwZS5sb2FkTW9yZVBvc3RzID0gZnVuY3Rpb24oYnV0dG9uLCB0YXJnZXQsIGF0dHJpYnV0ZXMpXG4gICAge1xuXG4gICAgICAgIHZhciBkYXRhID0gYXR0cmlidXRlcztcbiAgICAgICAgZGF0YS5hY3Rpb24gPSAnbW9kX3Bvc3RzX2xvYWRfbW9yZSc7XG4gICAgICAgIFxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdHlwZSA6IFwicG9zdFwiLFxuICAgICAgICAgICAgdXJsIDogZGF0YS5hamF4VXJsLFxuICAgICAgICAgICAgZGF0YSA6IGRhdGEsXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJodG1sXCIsXG4gICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24ocG9zdHMsIHN0YXR1cykge1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvL0FwcGVuZCBwb3N0c1xuICAgICAgICAgICAgICAgICAgICAkKHRhcmdldCkuYXBwZW5kKEpTT04ucGFyc2UocG9zdHMpKTtcblxuICAgICAgICAgICAgICAgICAgICAvL1JlbW92ZSBidXR0b24gaWYgbnVtYmVyIG9mIHBvc3RzIGlzIGxlc3MgdGhlbiBxdWVyaWVkIHBvc3QgY291bnRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMucG9zdHNQZXJQYWdlID4gcG9zdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUxvYWRlcihidXR0b24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVMb2FkZXIoYnV0dG9uKTtcblxuICAgICAgICAgICAgICAgICAgICAvL0luY3JlbWVudCBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5vZmZzZXQgPSBwYXJzZUludChhdHRyaWJ1dGVzLm9mZnNldCkgKyBwYXJzZUludChhdHRyaWJ1dGVzLnBvc3RzUGVyUGFnZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hdHRyKCdkYXRhLW1vZC1wb3N0cy1sb2FkLW1vcmUnLCB3aW5kb3cuYnRvYShKU09OLnN0cmluZ2lmeShhdHRyaWJ1dGVzKSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyAgPT09ICdub2NvbnRlbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlTG9hZGVyKGJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hZnRlcignPHA+Tm8gbW9yZSBwb3N0cyB0byBzaG934oCmPC9wPicpO1xuICAgICAgICAgICAgICAgICAgICBidXR0b24ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGVycm9yIDogZnVuY3Rpb24oanFYSFIsIHN0YXR1cywgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIExvYWRNb3JlQnV0dG9uLnByb3RvdHlwZS5yZW1vdmVMb2FkZXIgPSBmdW5jdGlvbihidXR0b24pIHtcbiAgICAgICAgaWYgKCQoYnV0dG9uLm5leHQoKSkuaGFzQ2xhc3MoJ2xvYWRpbmcnKSkge1xuICAgICAgICAgICAgYnV0dG9uLm5leHQoKS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBMb2FkTW9yZUJ1dHRvbi5wcm90b3R5cGUuYXR0cmlidXRlc0V4aXN0cyA9IGZ1bmN0aW9uKHJlcXVpcmVkS2V5cywgYXR0cmlidXRlS2V5cykge1xuICAgICAgICB2YXIgZXhpc3RzID0gdHJ1ZTtcblxuICAgICAgICByZXF1aXJlZEtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlS2V5cy5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgZXhpc3RzID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICB0aHJvdyAnVmFsaWRhdGlvbkVycm9yOiBNaXNzaW5nIHJlcXVpcmVkIGRhdGEtYXR0cmlidXRlIGtleSBcIicgKyBrZXkgKyAnXCInO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZXhpc3RzO1xuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IExvYWRNb3JlQnV0dG9uKCk7XG5cbn0pKGpRdWVyeSk7XG4iXSwic291cmNlUm9vdCI6IiJ9